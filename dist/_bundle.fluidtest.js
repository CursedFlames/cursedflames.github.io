!function(n){var o={};function u(i){if(o[i])return o[i].exports;var m=o[i]={i:i,l:!1,exports:{}};return n[i].call(m.exports,m,m.exports,u),m.l=!0,m.exports}u.m=n,u.c=o,u.d=function(n,o,i){u.o(n,o)||Object.defineProperty(n,o,{enumerable:!0,get:i})},u.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},u.t=function(n,o){if(1&o&&(n=u(n)),8&o)return n;if(4&o&&"object"==typeof n&&n&&n.__esModule)return n;var i=Object.create(null);if(u.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&o&&"string"!=typeof n)for(var m in n)u.d(i,m,function(o){return n[o]}.bind(null,m));return i},u.n=function(n){var o=n&&n.__esModule?function(){return n.default}:function(){return n};return u.d(o,"a",o),o},u.o=function(n,o){return Object.prototype.hasOwnProperty.call(n,o)},u.p="",u(u.s="./build/fluidtest/main.js")}({"./build/fluidtest/main.js":function(n,o,u){"use strict";o.__esModule=!0;var i=u("./build/fluidtest/util.js"),m=new URL(window.location.href),v=m.searchParams,f=40,A=30,D=16,x=v.get("width"),T=null==x?f:+x||f,E=v.get("height"),b=null==E?A:+E||A,M=v.get("degrad"),y=null==M?D:+M||D,I=!0,p=document.getElementById("widthInput");p instanceof HTMLInputElement?p.value=""+T:console.warn("Element #widthInput is missing or is not an input. This shouldn't happen.");var B=document.getElementById("heightInput");B instanceof HTMLInputElement?B.value=""+b:console.warn("Element #heightInput is missing or is not an input. This shouldn't happen.");var k=document.getElementById("degradInput");k instanceof HTMLInputElement?k.value=""+y:console.warn("Element #degradInput is missing or is not an input. This shouldn't happen.");var O=document.getElementById("reload");O instanceof HTMLButtonElement?O.onclick=function(){v.set("width",p instanceof HTMLInputElement?p.value:""+f),v.set("height",B instanceof HTMLInputElement?B.value:""+A),v.set("degrad",k instanceof HTMLInputElement?k.value:""+D),window.location.href=m.href}:console.warn("Element #reload is missing or is not a button. This shouldn't happen.");var j=document.getElementById("resetSettings");j instanceof HTMLButtonElement?j.onclick=function(){v.delete("width"),v.delete("height"),v.delete("degrad"),window.location.href=m.href}:console.warn("Element #resetSettings is missing or is not a button. This shouldn't happen."),console.log("Hello World!");for(var H={partialTicks:0,cells:[],currentTile:i.Tiles.GROUND,isEvenTick:!1},S=0;S<T;S++){for(var _=[],P=0;P<b;P++)_[P]=new i.Cell(i.Tiles.AIR);H.cells.push(_)}var U=document.getElementById("board");if(null==U)throw new Error("board is null");if(!(U instanceof HTMLCanvasElement))throw new Error("board is not canvas");var G=U,N=G.getContext("2d");if(null==N)throw new Error("canvas context is null");var R=N;G.setAttribute("style","position: relative; background-color: #777;"),G.width=T*(y+1),G.height=b*(y+1),G.onmousemove=function(n){if(1==(1&n.buttons)){var o=G.getBoundingClientRect(),u=n.clientX-o.left,m=n.clientY-o.top,v=Math.floor(u/(y+1)),f=Math.floor(m/(y+1));if(!(v<0||v>=T||f<0||f>=b)){var A=H.cells[v][f];H.currentTile instanceof i.Tile?(A.tile=H.currentTile,A.tile.solid&&(A.fluid=void 0,A.fluidAmount=0)):H.currentTile instanceof i.Fluid&&(A.fluid=H.currentTile,A.fluidAmount=y,A.tile.solid&&(A.tile=i.Tiles.AIR)),J()}}},G.onclick=G.onmousemove;var X=document.getElementById("palette");if(null!=X){for(var Y=X,q=function(n){var o=document.createElement("div");o.style.backgroundColor=n.color,o.onclick=function(){H.currentTile=n,J()},Y.appendChild(o)},z=0;z<i.TilesList.length;z++){q(i.TilesList[z])}for(z=0;z<i.FluidsList.length;z++){q(i.FluidsList[z])}}function J(){var n=H.currentTile,o=document.getElementById("palette");if(null!=o)for(var u=n instanceof i.Tile?i.TilesList.indexOf(n):i.TilesList.length+i.FluidsList.indexOf(n),m=0;m<o.children.length;m++){var v=o.children[m];v instanceof HTMLElement&&(m===u?(v.style.border="2px solid white",v.style.marginBottom="0px"):(v.style.border="0px",v.style.marginBottom="2px"))}for(var f=0;f<H.cells.length;f++)for(var A=H.cells[f],D=0;D<A.length;D++){var x=A[D];if(R.fillStyle=x.tile.color,R.fillRect(f*(y+1),D*(y+1),y,y),null!=x.fluid){if(R.fillStyle=x.fluid.color,x.tile!==i.Tiles.AIR&&(R.globalAlpha=.7),x.fluidAmount<y)R.fillRect(f*(y+1),D*(y+1)+y-x.fluidAmount,y,x.fluidAmount);else{var T=Math.max(0,Math.floor(51-3*(x.fluidAmount-y))),E=Math.max(0,Math.floor(51-3*(x.fluidAmount-y))),b=Math.max(0,Math.floor(255-15*(x.fluidAmount-y)));R.fillStyle="rgb("+T+","+E+","+b+")",R.fillRect(f*(y+1),D*(y+1),y,y),x.fluidAmount>y&&(R.fillStyle="#FFF",R.fillText(""+x.fluidAmount,f*(y+1),D*(y+1)+y/2))}R.globalAlpha=1}}}J();var K=document.getElementById("tick");function Q(n,o){var u=H.cells[n][o];if(null!=u.fluid){var i=H.cells[n][o-1],m=H.cells[n][o+1],v=null==H.cells[n-1]?void 0:H.cells[n-1][o],f=null==H.cells[n+1]?void 0:H.cells[n+1][o];if(null==u.nextDiff&&(u.nextDiff=0),null!=i&&null==i.nextDiff&&(i.nextDiff=0),null!=v&&null==v.nextDiff&&(v.nextDiff=0),null!=f&&null==f.nextDiff&&(f.nextDiff=0),null!=m){if(null==m.nextDiff&&(m.nextDiff=0),null==m.fluid&&!m.tile.solid)return m.fluid=u.fluid,m.nextDiff+=u.fluidAmount,void(u.nextDiff-=u.fluidAmount);var A=u.fluidAmount,D=!1;null!=i&&i.fluidAmount>=y&&u.fluidAmount>i.fluidAmount&&(D=!0);var x=Math.max(y,u.fluidAmount+(D?1:2));if(m.fluidAmount<x&&m.fluid==u.fluid){var T=0;if(m.fluidAmount<y?T=y-m.fluidAmount:x-m.fluidAmount>0&&(T=1),T>0){if(m.nextDiff+=T,!(u.fluidAmount>T))return void(u.nextDiff-=T);u.nextDiff-=T,A-=T}}if(null==v||v.tile.solid||null!=v.fluid&&v.fluid!==u.fluid||v.fluidAmount>=A)if(null==f||f.tile.solid||null!=f.fluid&&f.fluid!==u.fluid||f.fluidAmount>=A)   ;else{null==f.nextDiff&&(f.nextDiff=0);var E=A+f.fluidAmount;T=(I?Math.ceil(E/2):Math.floor(E/2))-f.fluidAmount;u.nextDiff-=T,A-=T,f.nextDiff+=(I?Math.ceil(E/2):Math.floor(E/2))-f.fluidAmount,f.fluid=u.fluid}else if(null==v.nextDiff&&(v.nextDiff=0),null==f||f.tile.solid||null!=f.fluid&&f.fluid!==u.fluid||f.fluidAmount>=A){E=A+v.fluidAmount,T=(I?Math.ceil(E/2):Math.floor(E/2))-v.fluidAmount;u.nextDiff-=T,A-=T,v.nextDiff+=(I?Math.ceil(E/2):Math.floor(E/2))-v.fluidAmount,v.fluid=u.fluid}else{null==f.nextDiff&&(f.nextDiff=0);for(var b=v.fluidAmount,M=f.fluidAmount,p=0;b<A||M<A;)b<M||b===M&&Math.random()<.5?b++:M++,A--,p++;u.nextDiff-=p,A-=p,v.nextDiff+=b-v.fluidAmount,v.fluid=u.fluid,f.nextDiff+=M-f.fluidAmount,f.fluid=u.fluid}if(A>y){if(null==i||i.tile.solid||null!=i.fluid&&i.fluid!==u.fluid)return;for(var B=null==i.fluidAmount?0:i.fluidAmount,k=0;B+k<A-k&&A-k>y;)k++;null==i.nextDiff&&(i.nextDiff=0),i.nextDiff+=k,i.fluid=u.fluid,u.nextDiff-=k}}else u.nextDiff=-1e3}}null!=K&&(K.onclick=function(){for(var n=H.cells[0].length-1;n>=0;n--){if(H.isEvenTick)for(var o=0;o<H.cells.length;o++)Q(o,n);else for(var o=H.cells.length-1;o>=0;o--)Q(o,n);for(var o=0;o<H.cells.length;o++){var u=H.cells[o][n],i=H.cells[o][n+1],m=H.cells[o][n-1];null!=u&&null!=u.fluid&&null!=u.nextDiff&&(u.fluidAmount+=u.nextDiff,u.fluidAmount<=0&&(u.fluid=void 0),u.nextDiff=void 0),null!=i&&null!=i.fluid&&null!=i.nextDiff&&(i.fluidAmount+=i.nextDiff,i.fluidAmount<=0&&(i.fluid=void 0),i.nextDiff=void 0),null!=m&&null!=m.fluid&&null!=m.nextDiff&&(m.fluidAmount+=m.nextDiff,m.fluidAmount<=0&&(m.fluid=void 0),m.nextDiff=void 0)}}H.isEvenTick=!H.isEvenTick,J()})},"./build/fluidtest/util.js":function(n,o,u){"use strict";o.__esModule=!0;var i=function(){return function(n,o){this.x=n,this.y=o}}();o.Pos=i;var m=function(){return function(n,o,u){void 0===o&&(o=0),this.tile=n,this.fluidAmount=o,this.fluid=u}}();o.Cell=m;var v=function(){return function(n,o){void 0===o&&(o=!1),this.color=n,this.solid=o}}();o.Tile=v,o.Tiles={AIR:new v("#AAC"),GROUND:new v("#222",!0)},o.TilesList=[o.Tiles.AIR,o.Tiles.GROUND];var f=function(){return function(n){this.color=n}}();o.Fluid=f,o.Fluids={WATER:new f("#3333FF")},o.FluidsList=[o.Fluids.WATER]}});